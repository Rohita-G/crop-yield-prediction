# Environmental Sensing and Crop Yield Modeling Report

**Date**: January 11, 2026
**Author**: Antigravity (AI Assistant)
**Subject**: Final Analysis of Corn Yield Prediction using Weather and Soil Data

---

## 1. Executive Summary
This project aimed to develop a predictive model for Corn Yield (Bushels per Acre) across the US Corn Belt using historical weather and soil data. Using a Random Forest Regressor trained on data from 1980 to 2017 (24,835 samples), we achieved a Mean Absolute Error (MAE) of **24.50 Bu/Acre** on the 2018 test set.

## 2. Methodology

### 2.1 Data Source
We utilized the **Khaki et al. (2020) Dataset**, which provides:
*   **Spatial Scope**: 763 counties across the US Corn Belt (e.g., Illinois, Iowa, Nebraska).
*   **Temporal Scope**: 1980 to 2018.
*   **Features**: 
    *   **Weather**: Weekly aggregates (Weeks 1-52) of Precipitation, Solar Radiation, Temperature (Min/Max), etc. (~312 columns).
    *   **Soil**: Measurements (Clay, Sand, Silt, Nitrogen, pH, etc.) at 6 depth levels (~66 columns).

### 2.2 Preprocessing
*   **Data Cleaning**: Rows with missing yield targets were removed.
*   **Feature Selection**: We utilized all available numeric weather and soil features.
*   **Splitting Strategy**: To simulate real-world forecasting, we used a temporal split:
    *   **Training Set**: Years 1980–2017.
    *   **Test Set**: Year 2018 (Unseen future data).
*   **Scaling**: Features were standardized using `StandardScaler` to normalize distributions (mean=0, variance=1).

### 2.3 Model Selection
We selected a **Random Forest Regressor** (`n_estimators=50`) for its ability to:
1.  Handle high-dimensional data (400+ features).
2.  Capture non-linear interactions between weather patterns and soil types.
3.  Provide interpretability via feature importance.

## 3. Results

### 3.1 Validation Metrics (2018 Test Set)
| Metric | Value | Interpretation |
|---|---|---|
| **MAE** | **24.50 Bu/Acre** | On average, our prediction deviates from the actual yield by 24.5 bushels. |
| **RMSE** | **30.08 Bu/Acre** | Penalizes larger errors more heavily; consistent with MAE. |
| **R² Score** | **0.31** | The model explains ~31% of the variability in crop yield. |

### 3.2 Key Drivers (Feature Importance)
The model identified the following as top predictors:
1.  **Soil Properties**: `phh2o` (Soil pH), `clay`, `sand`, and `nitrogen` content at various depths were consistently high-ranking features.
2.  **Weather Patterns**: Specific weekly temperature and precipitation markers played a role, though soil characteristics dominated the top feature list, suggesting that regional geography is a strong baseline predictor of yield potential.

## 4. Discussion
The $R^2$ of 0.31 indicates that while weather and soil are significant factors, they do not tell the whole story. Crop yield is also heavily influenced by:
*   **Seed Genetics**: Improvements in hybrid seeds over time (not captured in dataset).
*   **Management Practices**: Fertilizer application timing, irrigation usage, and pest control.
*   **Extreme Events**: Localized flooding or hail that weekly weather averages might smooth out.

## 5. Conclusion & Recommendations
The developed model provides a baseline for yield estimation but requires additional data layers for high-precision forecasting.

**Recommendations for Future Work:**
1.  **Integrate Remote Sensing**: Add NDVI/EVI satellite imagery features to capture real-time vegetation health.
2.  **Hybrid Modeling**: Combine the Random Forest with a Long Short-Term Memory (LSTM) network to better model the *sequential* nature of weekly weather.
3.  **Hyperparameter Tuning**: Run a Grid Search to optimize tree depth and estimator count for marginal gains.

---
*Generated by Antigravity*
